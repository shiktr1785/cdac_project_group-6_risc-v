name: Issue Label Enforcement

on:
  issues:
    types: [opened, edited, labeled, unlabeled]

jobs:
  enforce-labels:
    runs-on: ubuntu-latest
    steps:
      - name: Check labels
        uses: actions/github-script@v7
        with:
          script: |
            const labels = context.payload.issue.labels.map(l => l.name);

            const hasWhat = labels.some(l =>
              l.startsWith('design-') || l.startsWith('verification-') || l === 'docs'
            );

            const hasWhy = ['feature','bug','enhancement','cleanup','test']
              .some(l => labels.includes(l));

            const hasWhen = labels.some(l => l.startsWith('P'));

            if (!hasWhat || !hasWhy || !hasWhen) {
              core.setFailed(
                'Issue must have WHAT, WHY, and WHEN labels.'
              );
            }
