name: Issue Project Automation

on:
  issues:
    types: [opened, closed]

permissions:
  issues: write
  repository-projects: write

jobs:
  project-sync:
    runs-on: ubuntu-latest

    steps:
      # -----------------------------------------
      # Add newly opened issues to project
      # -----------------------------------------
      - name: Add issue to project
        if: github.event.action == 'opened'
        env:
          GH_TOKEN: ${{ secrets.PROJECT_PAT }}
        run: |
          gh project item-add 4 \
            --owner @me \
            --url "${{ github.event.issue.html_url }}"

      # -----------------------------------------
      # Handle closed issue (status automation)
      # -----------------------------------------
      - name: Handle closed issue
        if: github.event.action == 'closed'
        run: |
          echo "Issue closed â€” Project automation will move it to Done"
